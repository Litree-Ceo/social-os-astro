---
const { avatar, name, handle, timestamp, content, imageUrl } = Astro.props;
---

<div class="post-card bg-gray-800 bg-opacity-40 backdrop-blur-md border border-gray-700 rounded-lg p-6 mb-8 shadow-lg transition-all duration-300 hover:border-cyan-400 hover:shadow-cyan-400/20">
  <div class="flex items-center mb-4">
    <img src={avatar} alt={`${name}'s avatar`} class="w-12 h-12 rounded-full mr-4 border-2 border-gray-600" />
    <div class="flex-grow">
      <p class="font-bold text-white">{name}</p>
      <p class="text-sm text-gray-400">@{handle} &middot; <span class="timestamp" data-timestamp={timestamp?.toDate()}>{timestamp?.toDate().toLocaleDateString()}</span></p>
    </div>
    <button class="text-gray-500 hover:text-white">
      <span>...</span>
    </button>
  </div>

  <p class="text-gray-300 mb-4">{content}</p>

  {imageUrl && <img src={imageUrl} alt="Post image" class="rounded-lg w-full mb-4 border border-gray-700"/>}

  <div class="flex justify-between text-gray-500">
    <button class="flex items-center space-x-2 hover:text-cyan-400">
      <span>C</span>
      <span>12</span>
    </button>
    <button class="flex items-center space-x-2 hover:text-green-400">
      <span>S</span>
      <span>8</span>
    </button>
    <button class="flex items-center space-x-2 hover:text-pink-400">
      <span>H</span>
      <span>42</span>
    </button>
    <button class="flex items-center space-x-2 hover:text-purple-400">
      <span>B</span>
      <span>1.2k</span>
    </button>
  </div>
</div>

<script>
  const formatTime = (date) => {
    if (!date) return '';
    const now = new Date();
    const postDate = new Date(date);
    const diffInSeconds = Math.floor((now - postDate) / 1000);

    if (diffInSeconds < 60) return 'Just now';
    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m`;
    if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h`;
    return postDate.toLocaleDateString();
  };

  document.querySelectorAll('.timestamp').forEach(ts => {
    const date = ts.dataset.timestamp;
    if (date) {
        ts.textContent = formatTime(date);
    }
  });
</script>
